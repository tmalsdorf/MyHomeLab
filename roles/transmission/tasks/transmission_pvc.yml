- name: Create Persistent Volume for Config
  kubernetes.core.k8s:
    state: present
    namespace: "{{ transmission_namespace }}"
    resource_definition:
      apiVersion: v1
      kind: PersistentVolume
      metadata:
        name: transmission-config-pv
      spec:
        capacity:
          storage: "2Gi" # Adjust size as needed
        accessModes:
          - ReadWriteMany
        nfs:
          path: "{{ transmission_config }}"
          server: "{{ transmission_storage_nfs_server_ip }}"
        storageClassName: transmission-config-pvc
        persistentVolumeReclaimPolicy: Retain

- name: Create Persistent Volume for Downloads
  kubernetes.core.k8s:
    state: present
    namespace: "{{ transmission_namespace }}"
    resource_definition:
      apiVersion: v1
      kind: PersistentVolume
      metadata:
        name: transmission-downloads-pv
      spec:
        capacity:
          storage: "10Gi" # Adjust size as needed
        accessModes:
          - ReadWriteMany
        nfs:
          path: "{{ transmission_downloads }}"
          server: "{{ transmission_storage_nfs_server_ip }}"
        storageClassName: transmission-downloads-pvc
        persistentVolumeReclaimPolicy: Retain

- name: Create PVC for Config
  kubernetes.core.k8s:
    state: present
    namespace: "{{ transmission_namespace }}"
    resource_definition:
      apiVersion: v1
      kind: PersistentVolumeClaim
      metadata:
        name: transmission-config-pvc
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: "2Gi"
        storageClassName: transmission-config-pvc
        volumeName: "transmission-config-pv"

- name: Create PVC for Downloads
  kubernetes.core.k8s:
    state: present
    namespace: "{{ transmission_namespace }}"
    resource_definition:
      apiVersion: v1
      kind: PersistentVolumeClaim
      metadata:
        name: transmission-downloads-pvc
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: "10Gi"
        storageClassName: transmission-downloads-pvc
        volumeName: "transmission-downloads-pv"